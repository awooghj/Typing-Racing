(this["webpackJsonptyping-login-mix"]=this["webpackJsonptyping-login-mix"]||[]).push([[0],{94:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n(1),r=n.n(s),a=n(52),o=n.n(a),i=n(6),l=n(2),j={login:function(e){return console.log(e),fetch("/user/login",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{isAuthenticated:!1,user:{username:"",role:""}}}))},register:function(e){return console.log(e),fetch("/user/register",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},logout:function(){return fetch("/user/logout").then((function(e){return e.json()})).then((function(e){return e}))},isAuthenticated:function(){return fetch("/user/authenticated").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{isAuthenticated:!1,user:{username:"",role:""}}}))}},u=Object(s.createContext)(),b=function(e){var t=e.children,n=Object(s.useState)(null),r=Object(l.a)(n,2),a=r[0],o=r[1],i=Object(s.useState)(!1),b=Object(l.a)(i,2),m=b[0],d=b[1],h=Object(s.useState)(!1),O=Object(l.a)(h,2),x=O[0],p=O[1];return Object(s.useEffect)((function(){j.isAuthenticated().then((function(e){o(e.user),d(e.isAuthenticated),p(!0)}))}),[]),Object(c.jsx)("div",{children:x?Object(c.jsx)(u.Provider,{value:{user:a,setUser:o,isAuthenticated:m,setIsAuthenticated:d},children:t}):Object(c.jsx)("h1",{children:"Loading"})})};function m(e){var t=Object(s.useContext)(u),n=t.isAuthenticated,r=t.user,a=t.setIsAuthenticated,o=t.setUser,l=function(){j.logout().then((function(e){e.success&&(o(e.user),a(!1))}))};return Object(c.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:[Object(c.jsx)(i.b,{to:"/",children:Object(c.jsx)("div",{className:"navbar-brand",children:"Type Racing"})}),Object(c.jsx)("div",{className:"container-fluid",children:Object(c.jsx)("div",{className:"collapse navbar-collapse",id:"navbarText",children:Object(c.jsx)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:n?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(i.b,{to:"/",children:Object(c.jsx)("li",{className:"nav-item nav-link",children:"Home"})}),Object(c.jsx)(i.b,{to:"/todos",children:Object(c.jsx)("li",{className:"nav-item nav-link",children:"Todos"})}),"admin"===r.role?Object(c.jsx)(i.b,{to:"/admin",children:Object(c.jsx)("li",{className:"nav-item nav-link",children:"Admin"})}):null,Object(c.jsx)(i.b,{to:"/",children:Object(c.jsx)("button",{type:"button",className:"btn btn-link nav-item nav-link",onClick:l,children:"Logout"})}),Object(c.jsx)(i.b,{to:"/game",children:Object(c.jsx)("li",{className:"nav-item nav-link",children:"Hall"})})]}):Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(i.b,{to:"/",children:Object(c.jsx)("li",{className:"nav-item nav-link",children:"Home"})}),Object(c.jsx)(i.b,{to:"/login",children:Object(c.jsx)("li",{className:"nav-item nav-link",children:"Login"})}),Object(c.jsx)(i.b,{to:"/register",children:Object(c.jsx)("li",{className:"nav-item nav-link",children:"Register"})})]})})})})]})}function d(){return Object(c.jsx)("h1",{children:"Home page"})}var h=n(14),O=n(4),x=function(e){var t="alert ";return e.message.msgError?t+="alert-danger":t+="alert-primary",t+" text-center"},p=function(e){return Object(c.jsx)("div",{className:x(e),role:"alert",children:e.message.msgBody})},f=function(e){var t=Object(s.useState)({username:"",password:""}),n=Object(l.a)(t,2),r=n[0],a=n[1],o=Object(s.useState)(null),i=Object(l.a)(o,2),b=i[0],m=i[1],d=Object(s.useContext)(u),x=function(e){a(Object(O.a)(Object(O.a)({},r),{},Object(h.a)({},e.target.name,e.target.value))),console.log(r)};return Object(c.jsxs)("div",{children:[Object(c.jsxs)("form",{onSubmit:function(t){t.preventDefault(),j.login(r).then((function(t){console.log(t);var n=t.isAuthenticated,c=t.user,s=t.message;n?(d.setUser(c),d.setIsAuthenticated(n),e.history.push("/todos")):m(s)}))},children:[Object(c.jsx)("h3",{children:"Please sign in"}),Object(c.jsx)("label",{htmlFor:"username",className:"sr-only",children:"Username:"}),Object(c.jsx)("input",{type:"text",name:"username",onChange:x,className:"form-control",placeholder:"Enter username"}),Object(c.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password:"}),Object(c.jsx)("input",{type:"password",name:"password",onChange:x,className:"form-control",placeholder:"Enter username"}),Object(c.jsx)("button",{className:"btn btn-lg btn-primary btn-block",type:"submit",children:"Log in"})]}),b?Object(c.jsx)(p,{message:b}):null]})},g=function(e){var t=Object(s.useState)({username:"",password:"",role:""}),n=Object(l.a)(t,2),r=n[0],a=n[1],o=Object(s.useState)(null),i=Object(l.a)(o,2),u=i[0],b=i[1],m=Object(s.useRef)(null);Object(s.useEffect)((function(){return function(){clearTimeout(m)}}),[]);var d=function(e){a(Object(O.a)(Object(O.a)({},r),{},Object(h.a)({},e.target.name,e.target.value))),console.log(r)};return Object(c.jsxs)("div",{children:[Object(c.jsxs)("form",{onSubmit:function(t){t.preventDefault(),j.register(r).then((function(t){var n=t.message;b(n),a({username:"",password:"",role:""}),n.msgError||(m=setTimeout((function(){e.history.push("/login")}),2e3))}))},children:[Object(c.jsx)("h3",{children:"Please register"}),Object(c.jsx)("label",{htmlFor:"username",className:"sr-only",children:"Username:"}),Object(c.jsx)("input",{type:"text",name:"username",value:r.username,onChange:d,className:"form-control",placeholder:"Enter username"}),Object(c.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password:"}),Object(c.jsx)("input",{type:"password",name:"password",value:r.password,onChange:d,className:"form-control",placeholder:"Enter username"}),Object(c.jsx)("label",{htmlFor:"role",className:"sr-only",children:"Role:"}),Object(c.jsx)("input",{type:"text",name:"role",value:r.role,onChange:d,className:"form-control",placeholder:"Enter role (admin/user)"}),Object(c.jsx)("button",{className:"btn btn-lg btn-primary btn-block",type:"submit",children:"Register"})]}),u?Object(c.jsx)(p,{message:u}):null]})};function v(e){return Object(c.jsx)("li",{children:e.todo.name})}var y={getTodos:function(){return fetch("/user/todos").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{message:{msgBody:"UnAuthorized",msgError:!0}}}))},postTodo:function(e){return fetch("/user/todo",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{message:{msgBody:"UnAuthorized"},msgError:!0}}))}};function N(){var e=Object(s.useState)({name:""}),t=Object(l.a)(e,2),n=t[0],r=t[1],a=Object(s.useState)([]),o=Object(l.a)(a,2),i=o[0],j=o[1],b=Object(s.useState)(null),m=Object(l.a)(b,2),d=m[0],h=m[1],O=Object(s.useContext)(u);Object(s.useEffect)((function(){y.getTodos().then((function(e){j(e.todos)}))}),[]);var x=function(){r({name:""})};return Object(c.jsxs)("div",{children:[Object(c.jsx)("ul",{className:"list-group",children:i.map((function(e){return Object(c.jsx)(v,{todo:e},e._id)}))}),Object(c.jsx)("br",{}),Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),y.postTodo(n).then((function(e){var t=e.message;x(),t.msgError?"UnAuthorized"===t.msgBody?(h(t),O.setUser({username:"",role:""}),O.setIsAuthenticated(!1)):h(t):y.getTodos().then((function(e){j(e.todos),h(t)}))}))},children:[Object(c.jsx)("label",{htmlFor:"todo",children:"Enter Todo"}),Object(c.jsx)("input",{type:"text",name:"todo",value:n.name,onChange:function(e){r({name:e.target.value})},className:"form-control",placeholder:"Please Enter Todo"}),Object(c.jsx)("button",{className:"btn btn-lg btn-primary btn-block",type:"submit",children:"Submit"})]}),d?Object(c.jsx)(p,{message:d}):null]})}function C(){return Object(c.jsx)("h1",{children:"Admin page"})}var k=n(3),S=n(7),w=Object(S.a)(),I=function(e){var t=Object(k.g)();return Object(c.jsxs)("div",{className:"text-center",children:[Object(c.jsx)("h1",{children:"Welcome to the Type Racer Clone"}),Object(c.jsx)("button",{type:"button",onClick:function(){return t.push("/game/create")},className:"btn btn-primary btn-lg mr-3",children:"Creat Game"}),Object(c.jsx)("button",{type:"button",onClick:function(){return t.push("/game/join")},className:"btn btn-primary btn-lg",children:"Join Game"})]})},D=n(54),E=n.n(D)()("http://localhost:3001",{transports:["websocket"]}),A=function(e){var t=Object(s.useState)(""),n=Object(l.a)(t,2),r=n[0],a=n[1];return Object(c.jsxs)("div",{className:"row",children:[Object(c.jsx)("div",{className:"col-sm"}),Object(c.jsxs)("div",{className:"col-sm-8",children:[Object(c.jsx)("h1",{className:"text-center",children:"Create Game"}),Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),E.emit("create-game",r)},children:[Object(c.jsxs)("div",{className:"form-group",children:[Object(c.jsx)("label",{htmlFor:"nickname",children:"Enter Nickname"}),Object(c.jsx)("input",{type:"text",name:"nickname",value:r,onChange:function(e){a(e.target.value)},placeholder:"Enter nickname",className:"form-control"})]}),Object(c.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]})]}),Object(c.jsx)("div",{className:"col-sm"})]})},F=function(e){var t=Object(s.useState)({gameID:"",nickName:""}),n=Object(l.a)(t,2),r=n[0],a=n[1],o=function(e){a(Object(O.a)(Object(O.a)({},r),{},Object(h.a)({},e.target.name,e.target.value)))};return Object(c.jsxs)("div",{className:"row",children:[Object(c.jsx)("div",{className:"col-sm"}),Object(c.jsxs)("div",{className:"col-sm-8",children:[Object(c.jsx)("h1",{className:"text-center",children:"Join Game"}),Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.log(r),E.emit("join-game",r)},children:[Object(c.jsxs)("div",{className:"form-group",children:[Object(c.jsx)("label",{htmlFor:"gameID",children:"Enter Game ID"}),Object(c.jsx)("input",{type:"text",name:"gameID",value:r.gameID,onChange:o,placeholder:"Enter Game ID",className:"form-control"}),Object(c.jsx)("label",{htmlFor:"nickName",children:"Enter Nickname"}),Object(c.jsx)("input",{type:"text",name:"nickName",value:r.nickName,onChange:o,placeholder:"Enter nickname",className:"form-control"})]}),Object(c.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]})]}),Object(c.jsx)("div",{className:"col-sm"})]})},T=function(e){var t=Object(s.useState)({CountDown:"",msg:""}),n=Object(l.a)(t,2),r=n[0],a=n[1];Object(s.useEffect)((function(){E.on("timer",(function(e){a(e)})),E.on("done",(function(){E.removeListener("timer")}))}),[]);var o=r.CountDown,i=r.msg;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h1",{children:o}),Object(c.jsx)("h3",{children:i})]})},P=function(e){var t=e.player,n=e.gameID,r=Object(s.useState)(!0),a=Object(l.a)(r,2),o=a[0],i=a[1];return t.isPartyLeader&&o?Object(c.jsx)("button",{type:"button",onClick:function(e){E.emit("timer",{playerID:t._id,gameID:n}),i(!1)},className:"btn btn-primary",children:"Start Game"}):null},W={backgroundColor:"#34eb77"},L=function(e,t){var n=e.slice(0,t.currentWordIndex);return n=n.join(" "),Object(c.jsxs)("span",{style:W,children:[n," "]})},_={textDecoration:"underline"},G=function(e,t){return Object(c.jsxs)("span",{style:_,children:[" ",e[t.currentWordIndex]]})},U=function(e,t){var n=e.slice(t.currentWordIndex+1,e.length);return n=n.join(" "),Object(c.jsxs)("span",{children:[" ",n]})},J=function(e){var t=e.words,n=e.player;return Object(c.jsxs)(c.Fragment,{children:[L(t,n),G(t,n),U(t,n)]})},M=function(e){var t=e.isOpen,n=e.isOver,r=e.gameID,a=Object(s.useState)(""),o=Object(l.a)(a,2),i=o[0],j=o[1],u=Object(s.useRef)(null);Object(s.useEffect)((function(){t||u.current.focus()}),[t]);return Object(c.jsxs)("div",{className:"row my-3",children:[Object(c.jsx)("div",{className:"col-sm"}),Object(c.jsx)("div",{className:"col-sm-4",children:Object(c.jsx)("form",{children:Object(c.jsx)("div",{className:"form-group",children:Object(c.jsx)("input",{type:"text",readOnly:t||n,onChange:function(e){var t=e.target.value;" "===t.charAt(t.length-1)?(E.emit("userInput",{userInput:i,gameID:r}),j("")):j(e.target.value)},value:i,className:"form-control",ref:u})})})}),Object(c.jsx)("div",{className:"col-sm"})]})},R=function(e,t){return 0!==e.currentWordIndex?(e.currentWordIndex/t*100).toFixed(2)+"%":0},B=function(e){var t=e.player,n=e.players,s=e.wordsLength,r=R(t,s);return Object(c.jsxs)("div",{children:[Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h5",{class:"mt-5 nav nav-pills pull-left",children:t.nickName}),Object(c.jsx)("div",{className:"progress my-1",children:Object(c.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:r},children:r})},t._id)]}),n.map((function(e){var n=R(e,s);return e._id!==t._id?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h5",{class:"mt-3 nav nav-pills pull-left",children:e.nickName}),Object(c.jsx)("div",{className:"progress my-1",children:Object(c.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:n},children:n})},e._id)]}):null}))]})},H=function(e){var t=function(e){return e.filter((function(e){return-1!==e.WPM})).sort((function(e,t){return e.WPM>t.WPM?-1:t.WPM>e.WPM?1:0}))}(e.players);return 0===t.length?null:Object(c.jsxs)("table",{className:"table  my-3",children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{scope:"col",children:"#"}),Object(c.jsx)("th",{scope:"col",children:"User"}),Object(c.jsx)("th",{scope:"col",children:"WPM"})]})}),Object(c.jsx)("tbody",{children:t.map((function(e,t){return Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{scope:"row",children:t+1}),Object(c.jsx)("td",{children:e.nickName}),Object(c.jsx)("td",{children:e.WPM})]})}))})]})},z=function(e){var t=e.gameID,n=Object(s.useState)(!1),r=Object(l.a)(n,2),a=r[0],o=r[1],i=Object(s.useRef)(null);return Object(c.jsxs)("div",{className:"row my-3 text-center",children:[Object(c.jsx)("div",{className:"col-sm"}),Object(c.jsxs)("div",{className:"col-sm-8",children:[Object(c.jsx)("h4",{children:"Send This Code to Your Friends for Them to Join"}),Object(c.jsxs)("div",{className:"input-group mb-3",children:[Object(c.jsx)("input",{type:"text",ref:i,value:t,readOnly:!0,className:"form-control"}),Object(c.jsx)("div",{className:"input-group-append",children:Object(c.jsxs)("button",{className:"btn btn-outline-secondary",onClick:function(e){i.current.select(),document.execCommand("copy"),o(!0)},type:"button",children:[" ","Copy Gamecode"]})})]}),a?Object(c.jsx)("div",{className:"alert alert-success",role:"alert",children:"Successfully Copied the Gamecode"}):null]}),Object(c.jsx)("div",{className:"col-sm"})]})},Y=function(e){var t=e.gameState,n=t._id,s=t.players,r=t.words,a=t.isOpen,o=t.isOver,i=function(e){return e.find((function(e){return e.socketID===E.id}))}(s);return""===n?Object(c.jsx)(k.a,{to:"/"}):Object(c.jsxs)("div",{className:"text-center",children:[Object(c.jsx)(J,{words:r,player:i}),Object(c.jsx)(B,{players:s,player:i,wordsLength:r.length}),Object(c.jsx)(M,{isOpen:a,isOver:o,gameID:n}),Object(c.jsx)(T,{}),Object(c.jsx)(P,{player:i,gameID:n}),Object(c.jsx)(z,{gameID:n}),Object(c.jsx)(H,{players:s})]})};function q(){var e=Object(s.useState)({_id:"",isOpen:!1,players:[],words:[]}),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(s.useEffect)((function(){return E.on("updateGame",(function(e){console.log(e),r(e)})),function(){E.removeAllListeners()}}),[]),Object(s.useEffect)((function(){""!==n._id&&w.push("/game/".concat(n._id))}),[n._id]),Object(c.jsx)(k.c,{history:w,children:Object(c.jsxs)(k.d,{children:[Object(c.jsx)(k.b,{exact:!0,path:"/",component:I}),Object(c.jsx)(k.b,{path:"/game/create",component:A}),Object(c.jsx)(k.b,{path:"/game/join",component:F}),Object(c.jsx)(k.b,{path:"/game/:gameID",render:function(e){return Object(c.jsx)(Y,Object(O.a)(Object(O.a)({},e),{},{gameState:n}))}})]})})}var K=n(24),Q=function(e){var t=e.component,n=e.roles,r=Object(K.a)(e,["component","roles"]),a=Object(s.useContext)(u),o=a.isAuthenticated,i=a.user;return Object(c.jsx)(k.b,Object(O.a)(Object(O.a)({},r),{},{render:function(e){return o?n.includes(i.role)?Object(c.jsx)(t,Object(O.a)({},e)):Object(c.jsx)(k.a,{to:{pathname:"/",state:{from:e.location}}}):Object(c.jsx)(k.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},V=function(e){var t=e.component,n=Object(K.a)(e,["component"]),r=Object(s.useContext)(u).isAuthenticated;return Object(c.jsx)(k.b,Object(O.a)(Object(O.a)({},n),{},{render:function(e){return r?Object(c.jsx)(k.a,{to:{pathname:"/",state:{from:e.location}}}):Object(c.jsx)(t,Object(O.a)({},e))}}))};var X=function(){return Object(c.jsxs)(i.a,{children:[Object(c.jsx)(m,{}),Object(c.jsx)(k.b,{exact:!0,path:"/",component:d}),Object(c.jsx)(V,{path:"/login",component:f}),Object(c.jsx)(V,{path:"/register",component:g}),Object(c.jsx)(Q,{path:"/todos",roles:["user","admin"],component:N}),Object(c.jsx)(Q,{path:"/admin",roles:["admin"],component:C}),Object(c.jsx)(Q,{path:"/game",roles:["user","admin"],component:q})]})},Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,95)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),s(e),r(e),a(e)}))};o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(b,{children:Object(c.jsx)(X,{})})}),document.getElementById("root")),Z()}},[[94,1,2]]]);
//# sourceMappingURL=main.cb9def07.chunk.js.map